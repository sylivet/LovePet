<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        @@include('layout/style.html')
        <title>header</title>
    </head>

    <body>
        @@include('layout/header.html')
<!-- =================================================側邊攔===================================================== -->
<div class="m_wrapper" id='app'>
    <my-aside :class="'-'+order" ></my-aside>
         
<!-- =================================================主要內容===================================================== -->
         <main >
            <h5>訂單管理</h5>
            <ul class="m_get_type">
                <li @click="order='complete'" ><span @click="chgfocus" >已完成</span><div  class="m_underline_3" :style="{ opacity: opacity }" ></div></li>
                <li @click="order='notyet'"><span @click="chgfocus" >未完成</span><div  class="m_underline_3" :style="{ opacity: opacity2 }" ></div></li>  
            </ul>
            <div class="m_underline_2"></div>

            <keep-alive>
            <component :is="order"></component>
            </keep-alive>

         </main>
    </div>
    @@include('layout/footer.html')
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- axios -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <!-- vue -->
    <script src="./vendors/vue/js/vue.js"></script>
    <!-- <script src="./js/m_aside_contrl.js"></script> -->
    <!-- <script src="./js/m_order_contrl.js"></script> -->
    <script>
        

        Vue.component('complete',{
            template: `
                <div>       
                    <section>
                        <ul class="m_item_details">
                            <li class="m_item_title"><p>type <span>shopping cart</span></p>
                                <p>order number <span>20200408996ZA_02</span></p>
                                <p>2020/04/08</p>
                            </li>
                            <li><h6>狀&emsp;&emsp;態</h6><p>已完成</p></li>
                            <li><h6>宅配地址</h6><p>北市中山區南京東路二段一號2樓</p></li>
                            <li><h6>總&emsp;&emsp;計</h6><p>NT $1000</p></li>
                            <li><h6>購買項目</h6><p>衣服*1</p><p>包包*1</p></li>
                            <li><h6>其他備註</h6><p>想要新貨</p></li>
                            <li><h6>新增留言</h6><p><img src="" alt="">無</p></li>
                        </ul>
            

                        <div class="m_buy_details"  :class="{ 'm_appear': isappear}">
                            <p>項目明細</p>
                            <table>
                                <tr class="m_item_title">
                                    <td  class="m_item_pic">圖片</td>
                                    <td  class="m_item_id">型號</td>
                                    <td  class="m_item_type">類別</td>
                                    <td  class="m_item_amount">數量</td>
                                    <td  class="m_item_price">金額</td>
                                </tr>
                                <tr>
                                    <td  class="m_item_pic"><img src="./img/member/shoppingsample1.png" alt=""></td>
                                    <td  class="m_item_id">AF0023001</td>
                                    <td  class="m_item_type">衣服 / M號 / 黑</td>
                                    <td  class="m_item_amount">1 pcs</td>
                                    <td  class="m_item_price">$600</td>
                                </tr>
                                <tr>
                                    <td  class="m_item_pic"><img src="./img/member/shoppingsample2.png" alt=""></td>
                                    <td  class="m_item_id">AF0023002</td>
                                    <td  class="m_item_type">包包 / M號 / 黑</td>
                                    <td  class="m_item_amount">1 pcs</td>
                                    <td  class="m_item_price">$400</td>
                                </tr>
                            </table>
                        </div>
            

                        <div class="m_msg_details " :class="{ 'm_appear': isappear}">
                            <p>留言紀錄</p>
                            <ul>
                                <li class="m_client_ask"><img src="./img/member/Profile-Male-PNG.jpg" alt=""><article><p>想要新貨可以嗎?</p><p>time 2020/04/22 16:00</p></article></li>
                                <li class="m_lovepet_re"><img src="./img/common/i_logo.png" alt=""><article><p>沒問題，我們都是新貨</p><p>time 2020/04/22 16:00</p></article></li>
                                <li class="m_client_ask"><img src="./img/member/Profile-Male-PNG.jpg" alt=""><article><p>好的，感謝!</p><p>time 2020/04/22 16:00</p></article></li>
                                <li class="m_lovepet_re"><img src="./img/common/i_logo.png" alt=""><article><p>不會，應該的。</p><p>time 2020/04/22 16:00</p></article></li>
                            </ul>
                        </div>
                        <div class="m_dt_streth_btn">
                            <input type="button" value="訂單明細" @click="dtoggle">
                        </div>
                        </section>
                </div>
            `,
       
            methods:{
                dtoggle(){
                    this.isappear = !this.isappear;
                },
            },
            data(){
                return{
                    isappear : true,
                };
            },
        });

       
        Vue.component('notyet',{
            template: `
                <div>
                    <section>
                        <p> 暫無此資料 </p>
                        <P> 訂單皆完成 </p>
                    </section> 
                </div>
            `,
        });


        Vue.component('my-aside',{
          template: 
              ` <aside>
                  <div>
                      <h5><a href="./member_index.html"><img src="./img/member/catlogo-8.png" alt=""><span>會員專區</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></a></h5>
                      <div class="m_underline_1"></div>
                      <ul>
                          <li><a href="./member_people.html"><img src="./img/member/catlogo-8.png" alt=""><span>我的帳號</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></a></li>
                          <li><a href="./member_pets.html"><img src="./img/member/catlogo-8.png" alt=""><span>我的寵物</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></a></li>
                          <li><a href="./member_order_management.html"><img src="./img/member/catlogo-8.png" alt=""><span>訂單管理</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></a></li>
                          <li class="m_little_li" ><img src="./img/member/catlogo-8.png" alt=""><span>已完成</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></li>
                          <li class="m_little_li" ><img src="./img/member/catlogo-8.png" alt=""><span>未完成</span><img src="./img/member/catlogo-8.png" alt="" class="m_imgblock"></li>
                      </ul>
                      <input type="button" value="登 出" @click="mleave" >
                  </div>
                 </aside>`,
          data(){
              return {
                  mconfirm: '確認登出嗎?',
              };
          },
          methods:{
              mleave(){   //--- 登出function
                  if(confirm(this.mconfirm) == true){
                  localStorage.clear();                            //清除local

                  $.ajax({                                         //清除session ID
                      method: "POST",
                      url: "./php/front_end_API/M_removesession_MID.php",
                      data: {},
                      dataType: "text",
                      success: function success(response) {
                      window.location.href="front_index.html";
                      },
                      error: function error(exception) {
                      alert("數據載入失敗: " + exception.status);
                      }
                  });

                  }else{

                  };
                  },
          },
       });

        new Vue({
            el: '#app',
            data: {
                order: 'complete',
                opacity: 1,
                opacity2: 0,

                mymember:[],
                mymemberpet:[],
            },
            methods:{
                chgfocus(){
                    if(this.opacity == 0){this.opacity = 1}else{this.opacity = 0}
                    if(this.opacity2 == 0){this.opacity2 = 1}else{this.opacity2 = 0}
                },
                getmymemberdata(info){
                    let self = this;

                        $.ajax({
                            type : "POST",	
                            url : "./php/front_end_API/M_apr_memberpeople.php",  
                            data : {  
                                MID : info,            //---透過 MID 去抓該筆會員資料
                            }, 
                            dataType : 'html' 
                            }).done(function(data){    //---載入成功
                                console.log(data);
                            self.mymember =  JSON.parse(data);
                            
                            }).fail(function(jqXHR){   //---載入失敗
                            alert("res為ID數據載入失敗: " + jqXHR.status);
                            });

                    },
                getmemberpetdata(info){
                let self = this;

                    $.ajax({
                        type : "POST",	
                        url : "./php/front_end_API/M_apr_memberpet.php",  
                        data : {  
                            MID : info,            //---透過 MID 去抓該筆會員資料
                        }, 
                        dataType : 'html' 
                        }).done(function(data){    //---載入成功
                            console.log(data);
                        self.mymemberpet =  JSON.parse(data);
                        
                        }).fail(function(jqXHR){   //---載入失敗
                        alert("res為ID數據載入失敗: " + jqXHR.status);
                        });

                },
            },
            created(){

                axios.post("php/front_end_API/M_getsession_MID.php").then((res)=>{
                this.getmymemberdata(res.data);
                this.getmemberpetdata(res.data);
                });


            },
        });



      </script>
    </body>

</html>
